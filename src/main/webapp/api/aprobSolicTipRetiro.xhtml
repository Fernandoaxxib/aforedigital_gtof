<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition template="/api/layaut2.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

	<f:metadata>
		<f:event listener="#{aprobSolicTipRetiro.iniciar}"
			type="preRenderView" />
	</f:metadata>


	<ui:define name="menu">
		<ui:include src="menu.xhtml" />
	</ui:define>

	<ui:define name="left">
		<ui:include src="graficas.xhtml" />
	</ui:define>

	<ui:define name="center">

		<p:panelGrid class="no-border no-padding" style="width: 100%">
			<p:row>
				<p:column>
					<ui:include src="subMenuTransacciones.xhtml" />
				</p:column>
				<p:column style="text-align:right">
					<h:form>
						<p:linkButton styleClass="green"
							outcome="/api/aprobSolicTipRetiro.jsf" includeViewParams="true"
							value="Aprobaciones">
							<f:param name="init" value="true" />
						</p:linkButton>
						<p:linkButton styleClass="blue" outcome="/api/ordenPago.jsf"
							includeViewParams="true" value="Reporte de alertas">
							<f:param name="init" value="true" />
						</p:linkButton>
					</h:form>
				</p:column>
			</p:row>
		</p:panelGrid>

		<h:form id="form">
			<p:panel header="Aprobaciones"
				style="margin-top:20px">
				<p:commandButton id="btnRecSolicPend"
					styleClass="blue ui-button-text" style="margin-right:30px"
					onclick="PF('listSolicitudes').clearFilters()"
					action="#{aprobSolicTipRetiro.recuperarSolicPendientes}"
					type="submit"
					update="form:table1 form:table1:totalRegistros form:result"
					oncomplete="PF('listSolicitudes').selectAllRows();"
					value="#{msg.aprob_boton_recuperarSolicitudes}" ajax="true" />


				<p:linkButton styleClass="blue ui-button-text"
					outcome="/api/ordenPago.jsf" includeViewParams="true"
					value="Generar reporte de alertas">
					<f:param name="init" value="true" />
				</p:linkButton>

				<p:dataTable id="table1" var="mon" class="sinfondo"
					value="#{aprobSolicTipRetiro.listSolicitudes}"
					widgetVar="listSolicitudes"
					emptyMessage="#{msg.aprob_msj_sinDatos}"
					filteredValue="#{aprobSolicTipRetiro.filtro}"
					globalFilterFunction="#{aprobSolicTipRetiro.globalFilterFunction}"
					selection="#{aprobSolicTipRetiro.selectedSolicitud}"
					rowKey="#{mon.numSolicitud}"
					style="padding-top:10px;margin-top:10px" rows="10" paginator="true"
					paginatorPosition="bottom" rowsPerPageTemplate="5,10,15">

					<p:ajax event="page" global="false" />
					<p:ajax event="filter" global="false" />



					<p:ajax event="rowSelectCheckbox"
						listener="#{aprobSolicTipRetiro.seleccion}"
						update="table1 table1:totalRegistros" global="false" />
					<p:ajax event="rowSelect"
						listener="#{aprobSolicTipRetiro.seleccion}"
						update="table1 table1:totalRegistros" global="false" />
					<p:ajax event="rowUnselectCheckbox"
						listener="#{aprobSolicTipRetiro.deseleccion}"
						update="table1 table1:totalRegistros" global="false" />
					<p:ajax event="rowUnselect"
						listener="#{aprobSolicTipRetiro.deseleccion}"
						update="table1 table1:totalRegistros" global="false" />



					<f:facet name="header">
						<p:outputPanel style="text-align:left;margin-bottom:20px;">
							<h:outputLabel style="margin-right:20px;font-weight:bold;" for="flt"
								value="#{msg.aprob_label_filtro}" />
							<p:inputText id="globalFilter"
								onkeyup="PF('listSolicitudes').filter()"
								style="width:530px;font-size:12px"
								placeholder="#{msg.aprob_label_pholder}">
								<p:ajax event="keyup" update="table1:totalRegistros"
									listener="#{aprobSolicTipRetiro.getCount}" global="false" />
							</p:inputText>
						</p:outputPanel>
					</f:facet>
					<f:facet name="header">
						<p:panelGrid class="no-border no-padding" style="margin-top:10px;">
							<p:row>
								<p:column
									style="text-align: left !important;width: 25px !important;">
									<p:commandButton styleClass="blue ui-button-text" type="submit"
										update="table1 table1:totalRegistros form:table1:count"
										action="#{aprobSolicTipRetiro.marcarTodos}"
										onclick="PF('listSolicitudes').selectAllRows()"
										value="#{msg.aprob_boton_marcar}" ajax="true" global="false" />
								</p:column>
								<p:column
									style="text-align: left !important;width: 30px !important;">
									<p:commandButton styleClass="blue ui-button-text" type="submit"
										update="table1 table1:totalRegistros form:table1:count"
										action="#{aprobSolicTipRetiro.desmarcarTodos}"
										onclick="PF('listSolicitudes').unselectAllRows()"
										value="#{msg.aprob_boton_desmarcar}" ajax="true"
										global="false" />
								</p:column>
								<p:column
									style="text-align: left !important;width: 65px !important;">
									<p:commandButton styleClass="blue ui-button-text"
										action="#{aprobSolicTipRetiro.aprobarSolicitud}" type="submit"
										onclick="PF('listSolicitudes').clearFilters()"
										update="table1 totalRegistros form:result form:table1:count"
										value="#{msg.aprob_boton_aprobar}" ajax="true" global="true" />
								</p:column>
								<p:column
									style="text-align: right !important;width: 100px !important;">
									<p:outputPanel>
										<h:outputLabel for="registros"
											value="#{msg.aprob_label_totalRegistros}"
											style="font-size:12px" />
										<h:outputText id="totalRegistros"
											value="#{aprobSolicTipRetiro.count}" style="font-size:12px" />
									</p:outputPanel>
								</p:column>
							</p:row>
						</p:panelGrid>
					</f:facet>
					<f:facet name="paginatorBottomLeft">
						<p:outputPanel style="margin-top:5px">
							<p:outputLabel value="Registros seleccionados: " />
							<p:outputLabel id="count"
								value="#{aprobSolicTipRetiro.seleccionados}" />
						</p:outputPanel>
					</f:facet>


					<p:column selectionMode="multiple"
						style="width:16px;text-align:center;" />
					<p:column headerText="#{msg.aprob_tabla_columna_noSolicitud}"
						width="70" selectRow="#{aprobSolicTipRetiro.seleccionado}">
						<h:outputText value="#{mon.numSolicitud}" style="float:right;" />
					</p:column>
					<p:column headerText="#{msg.aprob_tabla_columna_tran}" width="140">
						<h:outputText value="#{mon.transaccion}" />
					</p:column>
					<p:column headerText="#{msg.aprob_tabla_columna_subTran}"
						width="130">
						<h:outputText value="#{mon.subTransaccion}" />
					</p:column>
					<p:column headerText="#{msg.aprob_tabla_columna_fecOpe}"
						width="120">
						<h:outputText value="#{mon.fechaOperacion}" style="float:right">
							<f:convertDateTime type="date" pattern="dd-MM-yyyy HH:mm" />
						</h:outputText>
					</p:column>
					<p:column headerText="#{msg.aprob_tabla_columna_cuenta}" width="70">
						<h:outputText value="#{mon.codCuenta}" style="float:right" />
					</p:column>

					<p:column headerText="#{msg.aprob_tabla_columna_titular}">
						<h:outputText value="#{mon.nombre}" />
					</p:column>
				</p:dataTable>




				<ui:include src="processResult.xhtml">
					<ui:param name="base" value="#{aprobSolicTipRetiro}" />
				</ui:include>
			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>