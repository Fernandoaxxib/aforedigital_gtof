<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition template="layaut2.xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

	<f:metadata>
		<f:event listener="#{ventaTitulos.iniciar}" type="preRenderView"/>
	</f:metadata>
	
	<ui:define name="center">
		<ui:include src="menuTransaccionesDisposiciones.xhtml" />
		<h:outputStylesheet name="estilo-base.css" library="css" />
		<h:outputScript name="js/calendar-localization.js" />
		
		<p:messages id="messages" showDetail="true" closable="true">
			<p:autoUpdate />
		</p:messages>

		<h:form id="form">

			<p:panel id="busqueda" header="Módulo" style="margin-top:20px">
				<p:panelGrid id="pBusqueda" columns="1" styleClass="ui-noborder">
					<p:panelGrid id="fechas" columns="3">
						<p:outputLabel value="Fecha Corte" style="font-weight: bold" />
						<p:datePicker id="fechaInicial"
							inputStyle="width:120px; text-align:right;"
							value="#{ventaTitulos.fechaInicial}" showIcon="true" locale="es"
							pattern="dd-MM-yyyy" mindate="#{ventaTitulos.fechaActual}"
							readonlyInput="true" />

						<p:datePicker id="fechaFinal" value="#{ventaTitulos.fechaFinal}"
							inputStyle="width:120px; text-align:right;" showIcon="true"
							locale="es" pattern="dd-MM-yyyy"
							mindate="#{ventaTitulos.fechaActual}" readonlyInput="true" />
					</p:panelGrid>

					<p:outputPanel id="customPanel">
						<p:selectOneRadio id="customRadio" value="#{ventaTitulos.opcion}"
							layout="custom">
							<f:selectItem itemLabel="Todos" itemValue="T" />
							<f:selectItem itemLabel="Retiros" itemValue="R" />
							<f:selectItem itemLabel="Traspasos" itemValue="A" />
							<f:selectItem itemLabel="Lote" itemValue="V" />
							<f:selectItem itemLabel="Lote Corte" itemValue="L" />
						</p:selectOneRadio>

						<p:panelGrid columns="3" cellpadding="5">
							<p:radioButton id="opt1" for="customRadio" itemIndex="0" />
							<h:outputLabel for="opt1" value="Todos los módulos" />
							<h:outputLabel value="" />

							<p:radioButton id="opt2" for="customRadio" itemIndex="1" />
							<h:outputLabel for="opt2" value="Retiros" />
							<p:selectOneMenu style="width:200px" var="t"
								converter="selectOneMenuConverter"
								value="#{ventaTitulos.selectedTipoRetiro}">
								<f:selectItem itemLabel="#{msg.modDesParc_combo_default}"
									itemValue="#{null}" noSelectionOption="true" />
								<f:selectItems value="#{ventaTitulos.tipoRetiros}" var="c"
									itemLabel="#{c.descripcion}" itemValue="#{c}" />

								<p:column>
									<f:facet name="header">
										<h:outputText value="Descripción" />
									</f:facet>
									<h:outputText value="#{t.descripcion}" />
								</p:column>
								<p:column>
									<f:facet name="header">
										<h:outputText value="Monto" />
									</f:facet>
									<h:outputText value="#{t.montoMovimiento}">
										<f:convertNumber type="currency" currencySymbol="$" />
									</h:outputText>
								</p:column>
							</p:selectOneMenu>

							<p:radioButton id="opt3" for="customRadio" itemIndex="2" />
							<h:outputLabel for="opt3" value="Traspasos Afore-Afore" />
							<p:selectOneMenu style="width:200px" var="t"
								converter="selectOneMenuConverter"
								value="#{ventaTitulos.selectedLoteTraspaso}">
								<f:selectItem itemLabel="#{msg.modDesParc_combo_default}"
									itemValue="#{null}" noSelectionOption="true" />
								<f:selectItems value="#{ventaTitulos.loteTraspasos}" var="c"
									itemLabel="#{c.idLote}" itemValue="#{c}" />

								<p:column>
									<f:facet name="header">
										<h:outputText value="Lote" />
									</f:facet>
									<h:outputText value="#{t.idLote}" />
								</p:column>
								<p:column>
									<f:facet name="header">
										<h:outputText value="Monto" />
									</f:facet>
									<h:outputText value="#{t.montoMovimiento}">
										<f:convertNumber type="currency" currencySymbol="$" />
									</h:outputText>
								</p:column>
							</p:selectOneMenu>

							<p:radioButton id="opt4" for="customRadio" itemIndex="3" />
							<h:outputLabel for="opt4" value="Dev pago excs lote" />
							<p:selectOneMenu style="width:200px" var="t"
								converter="selectOneMenuConverter"
								value="#{ventaTitulos.selectedrgDevExces}">
								<f:selectItem itemLabel="#{msg.modDesParc_combo_default}"
									itemValue="#{null}" noSelectionOption="true" />
								<f:selectItems value="#{ventaTitulos.rgDevExces}" var="c"
									itemLabel="#{c.idLote}" itemValue="#{c}" />

								<p:column>
									<f:facet name="header">
										<h:outputText value="Lote" />
									</f:facet>
									<h:outputText value="#{t.idLote}" />
								</p:column>
								<p:column>
									<f:facet name="header">
										<h:outputText value="Monto" />
									</f:facet>
									<h:outputText value="#{t.montoMovimiento}">
										<f:convertNumber type="currency" currencySymbol="$" />
									</h:outputText>
								</p:column>
							</p:selectOneMenu>

							<p:radioButton id="opt5" for="customRadio" itemIndex="4" />
							<h:outputLabel for="opt5" value="Lote corte" />
							<p:inputText id="lote" value="#{ventaTitulos.lote}"
								style="width:215px"></p:inputText>
						</p:panelGrid>
					</p:outputPanel>



					<p:commandButton action="#{ventaTitulos.buscarMontos}"
						type="submit" value="Buscar" ajax="false" />

				</p:panelGrid>
			</p:panel>

			<p:panel id="siefore" header="Siefores" style="margin-top:20px">
				<p:dataTable id="ventaTable" var="ven" paginatorPosition="bottom"
					value="#{ventaTitulos.montos}" rows="10" paginator="true"
					rowsPerPageTemplate="5,10,15" selectionMode="single"
					selection="#{ventaTitulos.selectedSiefore}" rowKey="#{ven.siefore}">

					<p:ajax event="rowSelect" update="form" />

					<p:column headerText="Siefore">
						<h:outputText value="#{ven.siefore}" />
					</p:column>

					<p:column headerText="Monto total">
						<h:outputText value="#{ven.totVender}" style="float:right">
							<f:convertNumber type="currency" currencySymbol="$" />
						</h:outputText>
					</p:column>

					<p:column headerText="Valor cuota">
						<h:outputText value="#{ven.valCuota}" style="float:right">
							<f:convertNumber type="currency" currencySymbol="$" />
						</h:outputText>
					</p:column>

					<p:column headerText="Total cuotas">
						<h:outputText value="#{ven.totCuotas}" style="float:right">
							<f:convertNumber type="currency" currencySymbol="$" />
						</h:outputText>
					</p:column>

					<p:column headerText="Pesos fracc afore">
						<h:outputText value="#{ven.retiroAforeMND}" style="float:right">
							<f:convertNumber type="currency" currencySymbol="$" />
						</h:outputText>
					</p:column>

					<p:column headerText="Fracción afore">
						<h:outputText value="#{ven.retiroAforeTIT}" style="float:right">
							<f:convertNumber type="currency" currencySymbol="$" />
						</h:outputText>
					</p:column>

					<p:column headerText="Total cuotas vender">
						<h:outputText value="#{ven.totGeneralCuotas}" style="float:right">
							<f:convertNumber type="currency" currencySymbol="$" />
						</h:outputText>
					</p:column>
				</p:dataTable>

				<p:commandButton action="#{ventaTitulos.ventaTitulosMonitor}"
					style="margin-top:20px" rendered="#{ventaTitulos.mostrarVenta}"
					type="submit" value="Venta en monitor" ajax="false" />

				<p:commandButton action="#{ventaTitulos.ventaTitulosMonitorCT}"
					style="margin-top:20px" rendered="#{ventaTitulos.mostrarVentaCT}"
					type="submit" value="Venta en monitor corte trans" ajax="false" />
			</p:panel>

		</h:form>

	</ui:define>

	<ui:define name="left">
		<p:panel id="modulo" header="MÓDULO: TRANSACCIONES Y DISPOSICIONES." style="font-size:12px">
			<ui:include src="graficas.xhtml" />
		</p:panel>
	</ui:define>
	
</ui:composition>